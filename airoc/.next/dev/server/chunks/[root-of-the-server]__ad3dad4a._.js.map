{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///Users/lokeshluffy/Downloads/Excel-Automation/src/app/api/fill-excel/route.js"],"sourcesContent":["import { exec } from 'child_process';\nimport { promisify } from 'util';\nimport fs from 'fs';\nimport path from 'path';\n\nconst execAsync = promisify(exec);\n\nexport async function POST(request) {\n    try {\n        const config = await request.json();\n        const timestamp = Date.now();\n        const outputPath = path.join(process.cwd(), `AIROC_Plan_${timestamp}.xlsx`);\n\n        // Path to filler script\n        const scriptPath = path.join(process.cwd(), 'fill_excel_airoc.js');\n\n        // Pass full config as JSON string\n        const fullConfig = { ...config, outputPath };\n        const configStr = JSON.stringify(fullConfig).replace(/\"/g, '\\\\\"');\n\n        const command = `/usr/local/bin/node \\\"${scriptPath}\\\" \\\"${configStr}\\\"`;\n\n        await execAsync(command);\n\n        if (!fs.existsSync(outputPath)) {\n            throw new Error('Output file was not generated');\n        }\n\n        const fileBuffer = fs.readFileSync(outputPath);\n        const fileSize = fileBuffer.length;\n\n        // Cleanup temporary file\n        fs.unlinkSync(outputPath);\n\n        return new Response(new Uint8Array(fileBuffer), {\n            status: 200,\n            headers: {\n                'Content-Type': 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n                'Content-Disposition': `attachment; filename=\\\"AIROC_Comprehensive_Plan.xlsx\\\"`,\n                'Content-Length': fileSize.toString(),\n            },\n        });\n    } catch (error) {\n        console.error(\"API Error (AIROC):\", error);\n        return new Response(JSON.stringify({ error: error.message }), {\n            status: 500,\n            headers: { 'Content-Type': 'application/json' },\n        });\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,YAAY,IAAA,8GAAS,EAAC,2HAAI;AAEzB,eAAe,KAAK,OAAO;IAC9B,IAAI;QACA,MAAM,SAAS,MAAM,QAAQ,IAAI;QACjC,MAAM,YAAY,KAAK,GAAG;QAC1B,MAAM,aAAa,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,EAAE,UAAU,KAAK,CAAC;QAE1E,wBAAwB;QACxB,MAAM,aAAa,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;QAE5C,kCAAkC;QAClC,MAAM,aAAa;YAAE,GAAG,MAAM;YAAE;QAAW;QAC3C,MAAM,YAAY,KAAK,SAAS,CAAC,YAAY,OAAO,CAAC,MAAM;QAE3D,MAAM,UAAU,CAAC,sBAAsB,EAAE,WAAW,KAAK,EAAE,UAAU,EAAE,CAAC;QAExE,MAAM,UAAU;QAEhB,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,aAAa;YAC5B,MAAM,IAAI,MAAM;QACpB;QAEA,MAAM,aAAa,wGAAE,CAAC,YAAY,CAAC;QACnC,MAAM,WAAW,WAAW,MAAM;QAElC,yBAAyB;QACzB,wGAAE,CAAC,UAAU,CAAC;QAEd,OAAO,IAAI,SAAS,IAAI,WAAW,aAAa;YAC5C,QAAQ;YACR,SAAS;gBACL,gBAAgB;gBAChB,uBAAuB,CAAC,sDAAsD,CAAC;gBAC/E,kBAAkB,SAAS,QAAQ;YACvC;QACJ;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,IAAI;YAC1D,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;QAClD;IACJ;AACJ"}}]
}